<!DOCTYPE html>
<html>
<head>
    <title>Registration page </title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f7f7f7;
    }

    .container {
        width: 100%; 
        max-width: 1350px;
        margin: 40px auto;
        
    }

    .row {
        margin-right: -15px;
        margin-left: -15px;
    }

    .col-md-6 {
        width: 100%;
        float: left;
        position: relative;
        min-height: 1px;
        padding-right: 15px;
        padding-left: 15px;
    }

    .col-md-offset-3 {
        margin-left: auto;
        margin-right: auto;
        width: 100%; 
    }

    .panel {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        width: 100%;
    }

    .panel-primary {
        border-color: #337ab7;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .panel-heading {
        background-color: navy;
        color: #fff;
        border-color: #337ab7;
        padding: 10px 15px;
        border-bottom: 1px solid #337ab7;
        text-align: center;
    }

    .panel-body {
        padding: 15px;
    }

    .form-group {
        margin-bottom: 15px;
        text-align: left;
    }

    .form-control {
        width: 100%;
        height: 40px;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
    }

    .form-control:focus {
        border-color: #337ab7;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .btn-primary {
        background-color: navy;
        color: #fff;
        border-color: #337ab7;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 5px;
    }

    .btn-primary:hover {
        background-color: #23527c;
        border-color: #23527c;
    }

    .panel-footer {
        background-color: #f7f7f7;
        border-top: 1px solid navy;
        padding: 10px;
        text-align: right;
    }

    small {
        font-size: 12px;
        color: #666;
    }

    .text-center {
        text-align: center;
    }

    .panel-body h2 {
        margin-top: 0;
        margin-bottom: 20px;
    }
</style>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                <div class="panel panel-primary">
                    <div class="panel-heading text-center">
                        <h1>Aadhar 360 Form </h1>
                    </div>
                    <div class="panel-body">
                        <form id="kyc-form" action="/post" method="post">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" class="form-control" id="name" name="Name" required oninput="this.value = this.value.replace(/[^a-zA-Z ]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="aadharNumber">Aadhar number </label>
                                <input type="text" class="form-control" id="aadharNumber" name="aadharNumber" maxlength="12" pattern="\d{12}" required title="Aadhar number should be exactly 12 digits" oninput="this.value = this.value.replace(/[^0-9]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="dob">Date Of Birth </label>
                                <input type="date" class="form-control" id="dob" name="dob" required title="Enter valid DOB" min="1900-01-01" max="2006-12-31" />
                            </div>
                            <div class="form-group">
                                <label for="gender">Gender </label>
                                <select name="form-control" id="gender" name="gender">
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="phoneNumber">Phone Number </label>
                                <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" maxlength="10" pattern="\d{10}" required title="Phone number should be exactly 10 digits" oninput="this.value = this.value.replace(/[^0-9]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="emailid">Email id </label>
                                <input type="email" class="form-control" id="emailid" name="emailid" required/>
                            </div>
                            <div class="form-group">
                                <label for="fatherName">Father's or Guardianâ€™s Name </label>
                                <input type="text" class="form-control" id="fatherName" name="fatherName" required oninput="this.value = this.value.replace(/[^a-zA-Z ]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="nationality">Nationality </label>
                                <select name="form-control" id="nationality" name="nationality">
                                    <option value="Indian">Indian</option>
                                    <option value="Others">Others</option>                                
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="state">State </label>
                                <input type="text" class="form-control" id="state" name="state" required oninput="this.value = this.value.replace(/[^a-zA-Z ]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="city">City </label>
                                <input type="text" class="form-control" id="city" name="city" required oninput="this.value = this.value.replace(/[^a-zA-Z ]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="pinCode">PinCode </label>
                                <input type="text" class="form-control" id="pinCode" name="pinCode" maxlength="7" pattern="\d{6,7}" required title="Pincode should be 6 or 7 digits" oninput="this.value = this.value.replace(/[^0-9]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="emergency_contact_number">Emergency Contact Number </label>
                                <input type="text" class="form-control" id="emergency_contact_number" name="emergency_contact_number" maxlength="10" pattern="\d{10}" required title="Phone number should be exactly 10 digits" oninput="this.value = this.value.replace(/[^0-9]/g, '')"/>
                            </div>
                            <div class="form-group">
                                <label for="address">Address </label>
                                <input type="text" class="form-control" id="address" name="address" maxlength="70"required title="Enter a valid address" />
                            </div>
                            <button type="submit" id="submit-kyc" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                    <div class="panel-footer text-right">
                        <small>&copy; Aadhar 360 </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.1/dist/web3.min.js"></script>
    <script>
        const contractAddress = '0x745C484B40353Dd416D85431dae364b2Ed4242e9'; 
        const contractABI = [
            // ABI here...
        ];  

        let web3;
        let contract;
        let userAddress;

        if (typeof window.ethereum !== 'undefined' && typeof Web3 !== 'undefined') {
            web3 = new Web3(window.ethereum);
            contract = new web3.eth.Contract(contractABI, contractAddress);
        } else {
            alert('Please install MetaMask to interact with this application.');
        }

        async function getUserAddress() {
            const accounts = await web3.eth.requestAccounts();
            userAddress = accounts[0];
        }

        window.ethereum.on('accountsChanged', async (accounts) => {
            userAddress = accounts[0];
        });

        async function submitKYC(event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const aadharNumber = document.getElementById('aadharNumber').value;

            await getUserAddress();

            const networkId = await web3.eth.net.getId();
            if (networkId !== YOUR_EXPECTED_NETWORK_ID) {
                alert('Please switch to the correct network.');
                return;
            }

            try {
                await contract.methods.registerAadhaar(name, aadharNumber).send({ from: userAddress });
                document.getElementById('status-message').innerHTML = 'Your KYC application has been submitted!';
            } catch (error) {
                console.error(error);
                document.getElementById('status-message').innerHTML = 'Error submitting KYC. Please try again.';
            }
        }

        document.getElementById('kyc-form').addEventListener('submit', submitKYC);
    </script>
</body>
</html>